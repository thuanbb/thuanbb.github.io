<h3 id="introduction">Introduction</h3>

<p>Conditional random fields (CRFs) are a probabilistic framework for labeling and segmenting sequential data by maximizing the conditional probability <script type="math/tex">p(Y \| x)</script> over label sequences <script type="math/tex">Y</script> given a particular observation sequence <script type="math/tex">x</script>.
Formally, we define <script type="math/tex">G=(V,E)</script> to be an undirected graph such that there is a node <script type="math/tex">v \in V</script> corresponding to each of the random variables representing an elements <script type="math/tex">Y_v</script> of <script type="math/tex">Y</script>. If each random variable <script type="math/tex">Y_v</script> obeys the Markov property with respect to <script type="math/tex">G</script>, then <script type="math/tex">(Y, X)</script> is a conditional random field.</p>

<h3 id="preliminary">Preliminary</h3>

<h4 id="graphical-modeling">Graphical Modeling</h4>

<p>Graphical modeling is an insightful method of describing the distribution over many variables. It helps to factorize the monolithic distribution into the product of <strong>local functions</strong> that each depend on a much smaller subset of variables. For example, given an undirected graphical model over a full variable set <script type="math/tex">Y</script>, the distribution can be written as</p>

<script type="math/tex; mode=display">p(Y= \mathbf{y}) = \frac{1}{Z} \prod_{a=1}^A \Phi_a(\mathbf{y}_a).</script>

<p>Here <script type="math/tex">Y_a = y_a</script> are a subset of variables in <script type="math/tex">Y</script> given by fractorization. Different fractorization leads to different modeling of distribution. <script type="math/tex">Z</script> is the normalization factor that ensures the sum of probabilities equal to 1.</p>

<p>To better formalize the fractorization, a fractor graph is defined as a bipartite graph <script type="math/tex">G=(V, F, E)</script> in which nodes <script type="math/tex">V</script> denote the set of variables in the model, and nodes <script type="math/tex">F</script> denote the factors. The semantics of the factor graph is that if a variable node <script type="math/tex">Y_s</script> for <script type="math/tex">s \in V</script> is connected to a fractor node <script type="math/tex">\Phi_a</script> for <script type="math/tex">a \in F</script>, then <script type="math/tex">Y_s</script> is one of the arguments of <script type="math/tex">\Phi_a</script>.</p>

<h3 id="conditional-random-field">Conditional Random Field</h3>

<p>Let <script type="math/tex">G</script> be a factor graph over <script type="math/tex">X</script> and <script type="math/tex">Y</script>. Then <script type="math/tex">(X, Y)</script> is a conditional random field if for any value <script type="math/tex">\mathbf{x}</script> of <script type="math/tex">X</script>, the distribution <script type="math/tex">p(\mathbf{y} \| \mathbf{x})</script> fractorizes according to <script type="math/tex">G</script>. If <script type="math/tex">F=\{ \Phi_a \}</script> is the set of fractors in <script type="math/tex">G</script>, then the conditional distribution for a CRF is</p>

<script type="math/tex; mode=display">p(\mathbf{y} \| \mathbf{x}) = \frac{1}{Z(\mathbf{x})} \prod_{a=1}^A \Phi_a(\mathbf{y}_a, \mathbf{x}_a).</script>

<h3 id="crf-vs-mrf">CRF VS. MRF</h3>

<p><a href="http://homepages.inf.ed.ac.uk/csutton/publications/crftut-fnt.pdf">An Introduction to Conditional Random Fields</a>, Section 2.6.2</p>

<h3 id="reference">Reference</h3>
<p><a href="http://homepages.inf.ed.ac.uk/csutton/publications/crftut-fnt.pdf">An Introduction to Conditional Random Fields</a></p>

<p><a href="http://dirichlet.net/pdf/wallach04conditional.pdf">Conditional Random Fields: An Introduction</a></p>
